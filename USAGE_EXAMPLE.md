# 使用示例

本文档展示了一个完整的开发流程示例，帮助你快速理解如何使用 vibe-project-manager。

---

## 场景：开发一个简单的博客系统

### 第 1 步：初始化项目

```bash
# 创建新项目目录
mkdir blog-system
cd blog-system

# 使用 vibe-project-manager 初始化
/vibe init
```

**输出**：
```
正在初始化 vibe 项目...
已创建 .vibe/ 目录
已创建模板文件
初始化完成！
```

### 第 2 步：填写设计文档

编辑 `.vibe/design.md`，定义项目的设计：

```markdown
# 项目设计文档

## 架构设计

采用前后端分离架构：
- 前端：React + TypeScript
- 后端：Node.js + Express
- 数据库：MongoDB

## 设计约束

- 使用 RESTful API 设计
- 所有 API 返回 JSON 格式
- 必须包含错误处理
- 前端使用 TypeScript 严格模式

## 技术选型

- 前端框架：React 18
- UI 库：Tailwind CSS
- 状态管理：Zustand
- 后端框架：Express
- ORM：Mongoose

## 模块划分

1. 用户模块
2. 文章模块
3. 评论模块
4. 分类模块
```

### 第 3 步：创建任务

```bash
# 创建第一个任务（AI 会自动拆解为子任务）
/vibe create-task "实现用户认证模块"
```

**输出示例**：
```
正在分析目标：实现用户认证模块

任务拆解完成，已创建 5 个子任务：
  ✓ task-001.md - 设计用户数据库模型
  ✓ task-002.md - 实现用户注册 API
  ✓ task-003.md - 实现用户登录 API
  ✓ task-004.md - 添加 JWT 认证中间件
  ✓ task-005.md - 创建登录表单组件

子任务按执行顺序排列，有清晰的依赖关系。
```

**生成的子任务文件**：`.vibe/tasks/task-001.md`

```markdown
## 目标

设计用户数据库模型，支持用户注册和登录功能。

## 输入

- 项目设计文档（`.vibe/design.md`）
- 技术栈：MongoDB + Mongoose
- 无前置任务

## 输出

必须产生的文件、修改或成果：
- 创建 `/src/models/User.ts` - 用户模型
- 定义用户 Schema（username, email, passwordHash 等）
- 添加索引（email 唯一索引）
- 添加密码哈希方法

## 完成条件

什么样的状态算完成：
- 用户模型 Schema 定义完整
- 密码哈希方法实现并测试
- 索引配置正确
- 代码审查通过
```

**可选的主任务文件**：`.vibe/tasks/main-001-user-auth.md`

```markdown
## 目标

实现用户认证模块，支持用户注册、登录和权限验证。

## 输入

- 项目设计文档（`.vibe/design.md`）
- 技术栈：React + Express + MongoDB
- 用户需求文档

## 输出

- 完整的用户认证系统
- 前端登录表单
- 后端认证 API
- JWT 认证中间件

## 完成条件

- 所有子任务完成
- 整体功能测试通过
- 用户验收通过

## 子任务清单

- [x] task-001 - 设计用户数据库模型
- [ ] task-002 - 实现用户注册 API
- [ ] task-003 - 实现用户登录 API
- [ ] task-004 - 添加 JWT 认证中间件
- [ ] task-005 - 创建登录表单组件
```
- 用户可以注册新账户
- 用户可以登录
- 密码加密存储
- JWT Token 生成和验证正常
- API 单元测试通过
```

### 第 4 步：开始工作

```bash
/vibe letsgo
```

**输出示例**：
```
## 当前任务状态

当前项目处于初始化阶段，已完成：
- 项目结构初始化
- 设计文档填写
- 创建第一个任务：task-001 实现用户认证模块

## 推荐行动

1. 阅读 `.vibe/design.md` 理解项目设计
2. 阅读 `.vibe/tasks/task-001.md` 了解任务详情
3. 开始实现用户认证模块
```

### 第 5 步：执行任务

按照任务的描述，逐步实现功能：

1. 创建用户模型
2. 实现注册 API
3. 实现登录 API
4. 实现认证服务
5. 编写测试

### 第 6 步：更新状态

完成部分工作后，更新状态：

```bash
/vibe update-state "完成用户模型的创建和数据库连接配置"
```

**state.md 内容**：
```markdown
[2025-02-14 16:30:00] 开始项目开发
[2025-02-14 16:45:00] 完成用户模型的创建和数据库连接配置
[2025-02-14 17:00:00] 完成注册 API 的基本实现
```

### 第 7 步：标记任务完成

任务完成后，标记为完成：

```bash
/vibe complete-task 001
```

**任务文件更新**：
在 task-001.md 的 "## 完成条件" 部分添加：
```
✓ 用户可以注册新账户
✓ 用户可以登录
✓ 密码加密存储
✓ JWT Token 生成和验证正常
✓ API 单元测试通过

完成时间：2025-02-14 17:30:00
```

### 第 8 步：创建新任务

```bash
/vibe create-task "实现文章发布功能"
```

### 第 9 步：继续工作

```bash
/vibe letsgo
```

继续下一个任务的开发...

### 第 10 步：结束工作

当天工作结束前：

```bash
/vibe welldone
```

**state.md 更新**：
```markdown
[2025-02-14 16:30:00] 开始项目开发
[2025-02-14 16:45:00] 完成用户模型的创建和数据库连接配置
[2025-02-14 17:00:00] 完成注册 API 的基本实现
[2025-02-14 17:30:00] 完成任务 001：实现用户认证模块
[2025-02-14 18:00:00] 本次工作完成：
  - 完成 task-001（用户认证模块）
  - 创建 task-002（文章发布功能）
  - 文章模块设计完成

[2025-02-14 18:00:00] 当前假设：
  - MongoDB 性能满足当前需求
  - JWT Token 有效期设置为 7 天合适

[2025-02-14 18:00:00] 未解决问题：
  - 文章图片存储方案待定
  - 评论功能的实时性需求待确认

[2025-02-14 18:00:00] 当前断点：
  - 已完成任务：task-001
  - 进行中任务：task-002
  - 下一步：实现文章发布功能的后端 API
```

---

## 场景：会话崩溃恢复

### 情况说明

在开发过程中，AI 会话突然崩溃或关闭。需要恢复工作状态。

### 恢复步骤

```bash
# 1. 确认你在项目根目录
cd /path/to/blog-system

# 2. 执行恢复命令
/vibe aftercrash
```

**输出示例**：
```
我已理解当前进度：
- 上次工作完成了 task-001（用户认证模块）
- 当前假设是 MongoDB 性能满足需求，JWT Token 有效期 7 天
- 未解决的问题：文章图片存储方案、评论功能的实时性需求

我将如何继续：
1. 阅读 `.vibe/tasks/task-002.md` 了解任务详情
2. 继续实现文章发布功能的后端 API
3. 解决未解决的图片存储方案问题
```

---

## 完整工作流总结

```
项目初始化
    ↓
填写设计文档 (.vibe/design.md)
    ↓
创建任务 (/vibe create-task)
    ↓
开始工作 (/vibe letsgo)
    ↓
执行任务 (开发、测试)
    ↓
更新状态 (/vibe update-state)
    ↓
标记任务完成 (/vibe complete-task)
    ↓
结束工作 (/vibe welldone)
    ↓
[如果会话崩溃] → 恢复会话 (/vibe aftercrash) → 继续工作
```

---

## 高级用法

### 查看所有任务

```bash
/vibe list-tasks
```

**输出**：
```
任务列表：
[001] 实现用户认证模块 - ✅ 已完成
[002] 实现文章发布功能 - 🔄 进行中
[003] 实现文章列表展示 - ⏳ 待开始
```

### 查看当前状态

```bash
/vibe status
```

**输出**：显示 `.vibe/state.md` 的完整内容

### 更新特定任务

```bash
/vibe update-task 002 "添加文章草稿保存功能"
```

---

## 最佳实践

1. **每天工作结束时执行 `/vibe welldone`**
   - 确保状态是最新的
   - 为下次启动提供清晰的起点

2. **遇到技术难题时记录**
   - 在 `.vibe/decisions.md` 中记录重要的技术决策
   - 在 `.vibe/state.md` 中记录问题和假设

3. **任务粒度适中**
   - 每个任务应该在 1-2 天内可以完成
   - 任务之间要清晰的依赖关系

4. **保持设计文档稳定**
   - `.vibe/design.md` 是北极星，不应频繁修改
   - 如果确实需要修改，应该在 `.vibe/decisions.md` 中记录原因

5. **定期回顾**
   - 每周回顾一次已完成任务
   - 检查未解决问题
   - 验证假设是否正确

---

## 常见问题

### Q: 我可以直接编辑 `.vibe/` 目录下的文件吗？

A: 是的，这是推荐的。`.vibe/` 目录就是为了方便你直接编辑而设计的。特别是：
- `.vibe/state.md` - 应该频繁更新
- `.vibe/tasks/` 下的任务文件 - 可以编辑内容

### Q: 我误删了某个任务文件怎么办？

A: 可以重新创建任务：
```bash
/vibe create-task "任务标题"
```
然后手动编辑任务文件，补充详细内容。

### Q: 如何迁移旧项目到 vibe-project-manager？

A: 在旧项目根目录执行：
```bash
/vibe init
```
然后将旧项目的文档内容整理到相应的 `.vibe/` 文件中。

### Q: 可以同时进行多个任务吗？

A: 技术上可以，但推荐一次只专注于一个任务。如果有多个并行任务，可以：
1. 使用不同的任务文件
2. 在 `.vibe/state.md` 中记录每个任务的进度
3. 完成一个标记一个

---

## 总结

vibe-project-manager 提供了一个简单但强大的项目管理系统：
- **简单**：直观的命令结构
- **强大**：完整的状态管理和任务跟踪
- **灵活**：自由文本格式，适应各种项目需求
- **可恢复**：完善的会话恢复机制

通过持续使用这套系统，你可以：
1. 保持项目进度的清晰可见
2. 快速恢复中断的工作
3. 积累项目知识和决策历史
4. 提高团队协作效率
